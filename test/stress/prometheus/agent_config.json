{
  "agent": {
    "debug": true
  },
  "logs": {
    "metrics_collected": {
      "prometheus": {
        "prometheus_config_path": "/tmp/prometheus.yaml",
        "log_group_name": "CloudWatchAgentStress",
        "emf_processor": {
          "metric_namespace": "PrometheusPerformance",
          "metric_declaration": [
            {
              "source_labels": ["job", "instance_id"],
              "label_matcher": "^prometheus.*$",
              "dimensions": [
                ["job"],
                ["job", "instance_id"]
              ],
              "metric_selectors": [
                "^prometheus_test_counter.*",
                "^prometheus_test_gauge.*",
                "^prometheus_test_summary.*"
              ]
            }
          ]
        }
      }
    },
    "force_flush_interval": 5
  },
  "metrics": {
    "namespace": "CloudWatchAgentStress",
    "metrics_collected": {
      "procstat": [
        {
          "exe": "cloudwatch-agent",
          "measurement": [
            "cpu_usage",
            "memory_rss",
            "memory_swap",
            "memory_vms",
            "memory_data",
            "num_fds"
          ],
          "metrics_collection_interval": 1
        }
      ]
    },
    "append_dimensions": {
      "InstanceId": "${aws:InstanceId}"
    }
  }
}